--MLGW
/*
EXEC spa_AccessRights  @flag='i',@functional_user_id=NULL,@function_id_text='10101000,10101010,10101011,10101013,10101014,10101015,10101016,10101017,10101018,10101019,10101031,10101020,10101028,10101029,10101030,10101181,10101182,10101183,10101200,10101210,10101211,10101214,10101215,10102500,10102513,10102511,10102512,10102514,10102600,10102613,10102614,10102615,10102616,10102617,10102611,10102612,10105800,10105804,10105805,10105810,10105811,10105812,10105816,10105817,10105831,10105832,10105846,10105847,10105851,10105852,10105861,10105862,10105876,10105877,10105891,10105892,10105894,10105901,10105902,10105903,10101600,10101601,10101610,10101611,10101900,10101910,10101911,10102900,10102910,10102911,10102912,10101161,10101162,10101163,10101400,10101410,10101411,10101412,10101413,10101414,10101415,10101416,10102400,10102410,10211025,10211026,10211027,10211028,10211029,10211030,10211031,10211032,10211033,10211034,10211035,10211036,10211037,10211038,10211039,10211040,10211041,10211042,10211043,10211044,10211045,10211046,10211047,10211048,10211049,10211050,10211051,10211052,10211053,10211054,10211055,10211056,10211057,10211058,10211059,10211060,10211061,10211062,10211063,10211064,10211065,10211066,10211067,10104100,10104110,10104111,10104200,10104210,10104211,10104212,10104213,10104214,10104217,10104218,10104221,10104222,10104219,10104220,10104900,10104910,10104911,10211213,10211214,10211215,10211216,10104810,10104811,10104812,10104813,10106300,10131302,10131303,10131304,10131305,10131306,10131307,10131308,10131309,10131310,10131311,10131312,10131313,10131314,10131315,10131316,10131342,10131343,10131344,10131345,10131346,10131347,10131348,10131349,10131350,10131362,10131363,10131364,10131365,10131366,10131367,10131368,10131369,10131370,10131371,10131372,10131373,10131374,10131375,10131376,10131377,10131378,10131379,10131380,10131381,10131382,10106400,10106410,10106411,10106499,10106600,10106610,10106611,10106700,10106710,10106712,10122500,10122502,10122503,10122510,10122511,10122512,10122513,10122516,10122600,10122610,10122611,10106900,10106910,10106911,10106920,10111000,10111010,10111011,10111012,10111013,10111014,10111016,10111017,10111018,10111031,10111032,10111100,10111113,10111114,10111111,10111116,10111117,10111131,10111132,10111200,10111210,10111211,10111212,10131000,10131010,10131011,10131012,10131013,10131014,10131015,10131016,10131017,10131018,10131031,10131032,10131033,10131019,10131020,10131021,10131022,10131023,10131024,10131028,10131035,10131036,10131029,10131600,10151000,10151010,10161100,10161110,10161111,10162000,10162010,10162011,10163300,10163310,10163311,10163900,10163910,10163911,10165000,10165010,10166100,10166110,10166111,10166112,10161800,10161810,10161811,10163100,10163110,10163111,10163200,10163210,10166700,10166710,10167000,10162100,10162300,10162301,10162312,10162313,10162314,10162311,10162500,10163400,10163410,10163411,10163600,10163601,10163602,10163603,10163800,10163810,10164000,10164010,10164200,10164300,10164301,10164302,10164303,10164400,10164410,10164412,10164413,10164414,10166000,10166300,10166900,10166910,10166911,10166912,10163700,10163710,10163720,10163730,10163770,10166500,10166510,10166511,10166513,10166514,10164500,10164510,10164511,10164512,10181300,10181310,10181315,10181316,10181317,10182500,10182512,10182513,10182514,10182515,10182516,10182517,10182520,10182511,10183200,10183210,10183211,10183212,10183213,10181000,10181400,10183400,10183410,10183411,10183412,10183414,10183415,10184000,10101122,10101123,10101126,10101127,10101132,10101133,10101134,10101153,10101154,10101131,10191800,10201600,10201614,10201619,10201620,10201621,10201628,10201636,10201616,10201622,10201623,10201629,10201630,10201631,10201632,10201618,10201611,10201612,10201613,10201627,10201626,10201633,10201634,10201635,10201638,10201639,10201640,10201800,10201810,10201811,10201812,10201813,10201814,10201815,10111300,10111400,10141900,10142400,10161400,10162600,10171100,10201500,10201900,10202000,10202100,10202200,10221200,10221900,10222400,10234900,10234910,10235100,10235200,10235300,10235500,10235600,10235700,10235800,10236100,10236200,10236400,10236500,10236600,13121200,13160000,10202500,10202510,10202511,10210000,10220000,10235499,13190000,13200000,13210000,15190000',@role_id=NULL,@login_id='runaj',@role_user_flag='u',@entity_id='',@accessright=NULL,@rm_view_id=NULL
select * 
from dbo.SplitCommaSeperatedValues('10101000,10101010,10101011,10101020,10101181,10101182,10101183,10101200,10101210,10101211,10102500,10102510,10102511,10102512,10102600,10102610,10102611,10102612,10105800,10105804,10105805,10105810,10105811,10105812,10105816,10105817,10105831,10105832,10105846,10105847,10101600,10101601,10101610,10101611,10101900,10101910,10101911,10102900,10102910,10102911,10101161,10101162,10101163,10101400,10101410,10101411,10101412,10101413,10101414,10101415,10101416,10102400,10102410,10211017,10104100,10104110,10104111,10104200,10104210,10104211,10104212,10104213,10104214,10104217,10104218,10104221,10104222,10104219,10104220,10104900,10104910,10104911,10211213,10211214,10211215,10211216,10104810,10104811,10104812,10104813,10106300,10131302,10131303,10131304,10131305,10131306,10131307,10131308,10131309,10131310,10131311,10131312,10131313,10131314,10131315,10131316,10131342,10131343,10131344,10131345,10131346,10131347,10131348,10131349,10131350,10131362,10131363,10131364,10131365,10131366,10131367,10131368,10131369,10131370,10131371,10131372,10131373,10131374,10131375,10131376,10131377,10131378,10131379,10131380,10131381,10131382,10106400,10106410,10106411,10106600,10106610,10106611,10106700,10106710,10106712,10122500,10122502,10122503,10122510,10122511,10122512,10122513,10122516,10122600,10122610,10122611,10106900,10106910,10106911,10106920,10111000,10111011,10111012,10111013,10111014,10111016,10111017,10111031,10111032,10111100,10111110,10111111,10111116,10111117,10111131,10111132,10111200,10111211,10131000,10131010,10131011,10131012,10131013,10131014,10131015,10131016,10131018,10131031,10131032,10131033,10131019,10131020,10131021,10131022,10131023,10131024,10131028,10131035,10131036,10131029,10131600,10151000,10151010,10181300,10181310,10181315,10181316,10181317,10182500,10182510,10182511,10183000,10183010,10183011,10183012,10183013,10181000,10181400,10183400,10183410,10183411,10183412,10183414,10183415,10184000,10101122,10101123,10101126,10101127,10101130,10101131,10191800,10201100,10201600,10201614,10201619,10201620,10201621,10201628,10201636,10201616,10201622,10201623,10201629,10201630,10201631,10201632,10201618,10201611,10201612,10201613,10201627,10201626,10201633,10201634,10201635,10201638,10201800,10201810,10201811,10201812,10201813,10201814,10201815,10111300,10111400,10141700,10141900,10142400,10161400,10162600,10171100,10191900,10201500,10201900,10202000,10202100,10202200,10221200,10221900,10222400,10234900,10235100,10235200,10235300,10235500,10235600,10235700,10235800,10236100,10236200,10236400,10236500,10236600,13121200,13160000,10202500,10202510,10202511,10201210,10201211,10201212,10201213,10201214,10201215,12111900') sm 
	LEFT JOIN application_functions af
		ON sm.item = af.function_id
where af.function_id is null
 AND product_id = 10000000

select * from setup_menu where function_id =10230099

update setup_menu set function_id = 10181599
where function_id = 10181500
and product_category = 10000000

update setup_menu set parent_menu_id = 10181599
where parent_menu_id = 10181500
and product_category = 10000000




delete setup_menu where function_id in(
10181400,
10202300,
10221099,
10221100,
10231100,
10231200,
10237100,
10237200,
10236300,
10236700,
10235000,
10235900,
10236000,
10233200,
10233500,
10233800,
10234800,
10238000,
10232500,
10232600,
10232700,
10232900,
10231500,
10231600,
10231800, 
10230099
)
and product_category = 10000000

*/


--select function_id from setup_menu where product_category = 10000000 group by function_id  having count(1)> 1 
	
SELECT sm.product_category,
	sm.function_id,
	sm.display_name Menu,
	s.display_name [Parent Menu],
	sm.parent_menu_id
FROM setup_menu sm
CROSS APPLY (
	SELECT DISTINCT display_name
	FROM setup_menu
	WHERE function_id = sm.parent_menu_id
	) s
WHERE sm.function_id IN (
10141900,
10161400,
10162600,
10221200,
10221900,
10222400,
10234900,
10235100,
10235200,
10235300,
10235500,
10235600,
10235700,
10235800,
10236100,
10236200,
10236400,
10236500,
10236600,
13121200,
13160000
		)
	AND sm.product_category = 10000000
ORDER BY sm.function_id



	--Accounting Inventory
	--Accounting derivative Transaction Processing
	--Run Measurement Report
	--Run Hedge Cashflow Deferral Report


	select * from setup_menu where function_id in (10106499, 10235499, 13190000, 13200000, 13210000, 15190000)  and product_category = 10000000

	DELETE
FROM setup_menu
WHERE display_name IN (
'Load Forecast Report',
'Gas Storage Position Report',
'Pipeline Imbalance Report',
'Contract Settlement Report',
'Deal Settlement Report',
'Meter Data Report',
'Measurement Report',
'Period Change Values Report',
'AOCI Report',
'De-designation Values Report',
'Netted Journal Entry Report',
'Accounting Disclosure Report',
'Fair Value Disclosure Report',
'Assessment Report',
'Missing Assessment Values Report',
'Failed Assessment Values Report',
'Available Hedge Capacity Exception Report',
'Not Mapped Transaction Report',
'Tagging Audit Report',
'Hedge Ineffectiveness Report',
'Hedging Relationship Audit Report'
		)
	AND product_category = 10000000
